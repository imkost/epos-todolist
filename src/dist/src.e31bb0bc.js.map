{"version":3,"sources":["lib/epos.js","lib/epos-bem-class-processor.js","lib/epos-plugin-class-array.js","lib/epos-plugin-on-create.js","lib/epos-plugin-mount-unmount.js","store.js","ui/app.js","index.js","../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Object","assign","render","addPlugin","addRenderPlugin","dynamic","autorun","computed","compound","renderRaw","suspend","curGet","curComp","curNode","curStack","boundaryId","isStandaloneRender","events","getAllPossibleEventNames","plugins","afterRun","Set","_comp_","Symbol","_comps_","_usages_","_source_","_splice_","_trusted_","_children_","_isStream_","_boundaryId_","any","createSource","parentChange","isObject","createSourceObject","isArray","createSourceArray","object","get$","source","key","setSourceProp","defineProperties","set$","get","delete$","value","callFnsStack","undefined","change","prevValue","defineProperty","configurable","set","newValue","array","pop$","map","item","push$","shift$","unshift$","splice$","map$","fn","createStream","removed","length","start","removeCount","items","Math","max","min","i","splice","isFunction","value$","onStop","add","checkUsages","stop","parentStack","f","sourceArray","stream","onSplice","isStandalone","deps","comp","push","run","parentGet","parentComp","callFns","clear","child","Array","from","delete","template","result","prev","renderInternal","isSvg","window","Node","isStringOrNumber","document","createTextNode","renderObject","renderArray","renderFunction","isStream","renderStream","stateByPlugin","Map","plugin","preprocess","state","cleanupTemplate","node","tag","createElementNS","createElement","parentNode","includes","toLowerCase","addEventListener","slice","setAttributeSafe","children","toFlatArray","inner","appendChild","postprocess","setAttribute","removeAttribute","createBoundaryNodes","startNode","endNode","isFirstRun","nodes","newNodes","fragment","createDocumentFragment","newNode","nextSibling","removeNode","insertBefore","cursor","console","log","nodes2","nodesToRemove","bef","cc","c","ii","n","string","div","innerHTML","childNodes","remove","fns","args","call","startsWith","prototype","toString","flat","ordered","d","_deb","originalOrder","nextOrder","sort","compare","reorderChildren","withAnimation","root","order","renderItem","elem","rect","getBoundingClientRect","_prevPosition","left","top","forEach","index","indexOf","removeByIndex","nextItem","nextIndex","newElems","newElem","getFirstNodeByIndex","changePosition","itemAtIndex","delay","prevPosition","requestAnimationFrame","nextPosition","dx","dy","style","transition","transform","setTimeout","takeByIndex","isTake","nodesAtIndex","isIndex","removeChild","oldIndex","newIndex","nodesAtOldIndex","isOldIndex","firstNodeAtNewIndex","bemClassProcessor","props","className","name","mods","classes","keys","k","v","join","_prevClassList_","classProcessor","setClassProcessor","class","prevClassList","nextClassList","concat","filter","Boolean","split","classList","onCreate","elementsToObserve","onMount","onUnmount","startMo","mo","MutationObserver","mutations","__isMounted","contains","size","stopMo","__started","observe","childList","subtree","disconnect","store","init","initStore","st","data","App","todos","done","done$","onClick","text$","main","pluginClassArray","pluginOnCreate","pluginMountUnmount","text","$app","body","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","getElementById","stackTrace","innerText","getParents","modules","parents","dep","Function","cached","cache","some","cb"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"..","sourcesContent":["/* eslint-disable */\n\n/*\nКак трекать не реактивный set и возможный рассинхрон:\nхранить prevValue при реактивном set$, при get$ сравнивать реальное значение\nс prevValue (реактивное), если разные, значит рассинхрон.\nАналогично при реактивном set$ проверять.\n */\n\n\n/*\nВ compound нужно понимать, что нет дублирующихся реакций, убирать дубликаты\n */\n\n/*\n// Maybe implement lib/create-dynamic-array-from-object.js\n// createDynamicArrayFromObject(store.feeds).map$()\nlet prevFeedIds\nautorun(() => {\n  const feedIds = Object.values(store.feeds$).map(f => f.id)\n  if (!prevFeedIds) {\n    state.feedIdsOrder$ = feedIds\n  }\n  if (prevFeedIds) {\n    feedIds.forEach((feedId, index) => {\n      // New item? => add\n      if (!prevFeedIds.includes(feedId)) {\n        state.feedIdsOrder.splice$(index, 0, feedId)\n      }\n    })\n    prevFeedIds.forEach(feedId => {\n      // Item was removed? => remove\n      if (!feedIds.includes(feedId)) {\n        state.feedIdsOrder.splice$(state.feedIdsOrder.indexOf(feedId), 1)\n      }\n    })\n  }\n  prevFeedIds = feedIds\n})\n*/\n\n\n\n/*\nFor next version:\nobj / dobj (instead of object / source) dynamic-object\narr / darr (instead of array / sourceArray)\n*/\n\n\n/*\nIdea:\nEpos.dep(store, 'title') // same as store.get$('title') but ok with linters\nEpos.trigger(store, 'title') // force reactions\n*/\n\n\n/*\nidea: Epos.whyRun()\n{\n  class () {\n    Epos.whyRun()\n    return post.title$\n  }\n}\nlogs smth like:\n.class was run because it is first time run\n.class was run because 'title' of post {...} changed\n*/\n\n\n/*\nБыл такой момент:\ninner () {\n  if (!store.visible$) {\n    return null\n  }\n  if (!$post) {\n    $post = render(Post())\n  }\n  return $post\n}\nкогда visible$ будет меняться, элементы будут удаляться из DOM-а и с ними вся динамика, то есть\nдинамика на $post пропадет, это нежелаемое поведение.\n\nЧтобы избежать, render (который export-ируется, а не renderInternal) обернут в standalone-autorun\nпоэтому render внутри render теперь не создает parent-child связь, но нужно теперь не забывать\nsuspend-ить $post самостоятельно\n*/\n\n// TODO: throw exception if dynamic get not inside computation\n// TODO: add middle process for deleting only to prevent plugins conflicts (cleanupTemplate)\n//\n// idea: Epos.dynamic(value)\n// var hidden = Epos.dynamic(false)\n// hidden.set$(true), hidden.get$(), hidden.set(false), hidden.get()\n\n/**\n * Copyright (c) Konstantin Zemtsovsky\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/**\n * Эпос использует несколько своих внутренних понятий.\n * Пройдемся по каждому из них:\n *\n * 1. Мнимые поля у объекта.\n * Это non-enumarable поля создаваемые через Object.defineProperty.\n * К этим поляем можно обращаться, но их не получить через\n * `for (key in obj)` или `Object.keys(obj)`.\n *\n * 1. Источник (source).\n * Бывает двух типов: объект и массив.\n *\n * Источник-объект — это объект у которого для каждого поля существует такое\n * же мнимое поле, заканчивающееся на `$`. Например, для объекта {a, b}\n * источник будет выглядеть так: {a, b, a$, b$}, где a$ и b$ — мнимые поля.\n * У мнимых полей прописаны getter и setter, благодаря которым реализуется\n * реактивность.\n *\n * Источник-массив — это обычный массив с мнимыми методами push$/pop$/etc.\n * Эти методы превносят реактивность. В обычном javascript array.push\n * не изменяет значение массива, но в Эпосе sourceArray.push$ сработает так,\n * будто значение изменилось (на самом деле оно не изменится), то есть все\n * вычисления, зависящие от sourceArray, перевычислятся.\n *\n * 2. Динамичные поля у объекта-источника.\n * Это мнимые поля, которы заканчиваются на $ и у которых определены\n * специальные getter/setter о которых говорилось выше.\n *\n * 3. Вычисление (computation или просто comp).\n * TODO: добавить описание\n *\n * 4. Потоки (streams).\n * TODO: добавить описание\n */\n\nObject.assign(render, { addPlugin: addRenderPlugin })\n\nexport default {\n  dynamic,\n  autorun,\n  computed,\n  compound,\n\n  // DOM-related\n  render,\n  renderRaw,\n  suspend\n}\n\nexport {\n  dynamic,\n  autorun,\n  computed,\n  compound,\n\n  // DOM-related\n  render,\n  renderRaw,\n  suspend\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Function to be called on reactive getter.\n */\nlet curGet = null\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Current reactive computation. Computations are created by `autorun`.\n */\nlet curComp = null\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Current node created via `renderObject`\n */\nlet curNode = null\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * List of all delayed reactions. Used for compound.\n */\nlet curStack = null\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Counter for creating boundary nodes.\n */\nlet boundaryId = 1\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nlet isStandaloneRender = false;\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * List of all possible event names: \"onclick\", \"onmousedown\", etc.\n */\nconst events = getAllPossibleEventNames()\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * List of render plugins.\n */\nconst plugins = []\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Набор функций, которые будут выполнены, когда root-computation\n * перевычислится. Под рутовым вычислением имеется в виду тот, который\n * перевычислился при реактивном измененнии одной из своих зависимостей,\n * а не тот, который перевычислился из-за того, что его родитель-computation\n * перевычислился. Этот набор нужен для реализации `computed`.\n */\nconst afterRun = new Set()\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * All symbols used by Epos\n */\nconst _comp_ = Symbol('comp')\nconst _comps_ = Symbol('comps')\nconst _usages_ = Symbol('usages')\nconst _source_ = Symbol('source')\nconst _splice_ = Symbol('splice')\nconst _trusted_ = Symbol('trusted')\nconst _children_ = Symbol('children')\nconst _isStream_ = Symbol('isStream')\nconst _boundaryId_ = Symbol('boundaryId')\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction dynamic (any) {\n  return createSource(any)\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction createSource (any, parentChange) {\n  if (isObject(any)) {\n    return createSourceObject(any, parentChange)\n  }\n\n  if (isArray(any)) {\n    return createSourceArray(any, parentChange)\n  }\n\n  return any\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction createSourceObject (object, parentChange) {\n  if (object.get$) {\n    return object\n  }\n\n  const source = {}\n\n  for (const key in object) {\n    setSourceProp(key, object[key])\n  }\n\n  Object.defineProperties(source, {\n    set$: { get: () => set$ },\n    delete$: { get: () => delete$ },\n    get$: { get: () => get$ }\n  })\n\n  return source\n\n  function set$ (key, value) {\n    setSourceProp(key, value)\n    if (parentChange) {\n      callFnsStack(parentChange)\n    }\n  }\n\n  function delete$ (key) {\n    source[`${key}$`] = undefined\n    delete source[key]\n    delete source[`${key}$`]\n    if (parentChange) {\n      callFnsStack(parentChange)\n    }\n  }\n\n  function get$ (key) {\n    if (key in source) {\n      return source[`${key}$`]\n    }\n    // TODO: implement dynamic setting and deleting\n  }\n\n  function setSourceProp (key, value) {\n    const change = new Set() // fns to be called on reactive value change\n    source[key] = createSource(value, change)\n    let prevValue = source[key]\n\n    Object.defineProperty(source, `${key}$`, {\n      configurable: true, // for `delete source['key$']` to work\n      get () {\n        if (!curComp && !source[_trusted_]) {\n          // console.warn(`Referencing a dynamic field \"${key}\" without a computational context or function`)\n        }\n        if (curGet) {\n          curGet(change)\n        }\n        return source[key]\n      },\n      set (newValue) {\n        if (prevValue !== newValue) {\n          source[key] = createSource(newValue, change)\n          callFnsStack(change)\n        }\n        prevValue = newValue\n        return true\n      }\n    })\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction createSourceArray (array, parentChange) {\n  if (array.pop$) {\n    return array\n  }\n\n  const source = array.map(item => createSource(item))\n  source[_splice_] = new Set() // fns to be called after splice$\n\n  // TODO: add sort$ and reverse$\n  Object.defineProperties(source, {\n    pop$: { get: () => pop$ },\n    push$: { get: () => push$ },\n    shift$: { get: () => shift$ },\n    unshift$: { get: () => unshift$ },\n    splice$: { get: () => splice$ },\n    map$: { get: () => map$ }\n  })\n\n  return source\n\n  function map$ (fn) {\n    return createStream(source, fn)\n  }\n\n  /**\n   * All of these functions are implemented via splice$. Why?\n   * It's just simpler, we impelement reactivity only for splice$ and get\n   * reactivity for all the reset functions for free.\n   */\n  function pop$ () {\n    const removed = splice$(source.length - 1, 1)\n    return removed[0]\n  }\n  function push$ (item) {\n    splice$(source.length, 0, item)\n    return source.length\n  }\n  function shift$ () {\n    const removed = splice$(0, 1)\n    return removed[0]\n  }\n  function unshift$ (item) {\n    splice$(0, 0, item)\n    return source.length\n  }\n\n  function splice$ (start, removeCount, ...items) {\n    /**\n     * Make `start` and `removeCount` usage-friendly.\n     *\n     * start и removeCount могут быть любыми числами, например, они могут быть\n     * отрицательными или выходить за размеры массива. Оригинальный js-овский\n     * splice поддерживает всевозможные случаи. Для удобства, мы переводим\n     * нестандартные значения в равносильные, но более удобные:\n     * start не может быть меньше нуля и больше размера массива,\n     * removeCount тоже неотрицательный и не может \"выходить\" за размеры\n     * массива.\n     * TODO: прочекать, что будет, если передавать нецелые числа\n     * TODO: прочекать, что будет, если передавать не числа\n     */\n    if (start < 0) {\n      start = Math.max(0, source.length + start)\n    } else if (start > source.length - 1) {\n      start = source.length\n    }\n    removeCount = Math.max(0, Math.min(source.length - start, removeCount))\n\n    // Every item to source\n    items = items.map(i => createSource(i))\n\n    // Call original splice\n    const removed = source.splice(start, removeCount, ...items)\n\n    // Call splice$ listeners\n    callFnsStack(source[_splice_], start, removeCount, ...items)\n\n    // Call `parentChange`, because splice$ changes array (in reactivity)\n    if (parentChange) {\n      callFnsStack(parentChange)\n    }\n\n    return removed\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction computed (fn) {\n  if (!isFunction(fn)) {\n    return fn\n  }\n\n  // If `computed` was never run for the given function\n  if (!fn[_source_]) {\n    // Создаем счетчик использований, который говорит сколько раз computed\n    // от переданной функции вызывался внутри computation-ов\n    fn[_usages_] = 0\n\n    // Создаем источник для функции со значением undefined\n    fn[_source_] = createSource({\n      value: void 0\n    })\n    fn[_source_][_trusted_] = true\n\n    // Перевычисляем значение в standalone-computation (передаем true в авторан)\n    fn[_comp_] = autorun(() => {\n      // TODO: в юнифиде в некоторых ситуациях получалось так, что autorun\n      // бежит, а _source_ уже нет. Баг? Или ок?\n      // UPD: скорее всего было связано с тем, что не было suspend,\n      // закмментирую if, проверим\n      // UPD2: все-таки нужно if. Надо разобраться почему\n      if (fn[_source_]) {\n        fn[_source_].value$ = fn()\n      }\n    }, true)\n  }\n\n  // Если мы внутри computation-а\n  if (curComp) {\n    // Увеличиваем счетчик использований\n    fn[_usages_] += 1\n\n    onStop(curComp, () => {\n      // Когда computation останавливается, понижаем счетчик использований.\n      // Если внутри computation-а computed от одной функции вызовется\n      // дважды, то счетчик увеличится на 2, а при остановке уменьшится\n      // на 2 — все ок.\n      fn[_usages_] -= 1\n\n      // Как только рутовый computation закончится, нужно проверить, что\n      // computed от функции нигде больше не используется ...\n      afterRun.add(checkUsages)\n\n      function checkUsages () {\n        // ... И если он действительно больше нигда не используется\n        if (fn[_usages_] === 0) {\n          // То останавливаем computation\n          fn[_comp_].stop()\n\n          // Обнуляем source\n          fn[_source_] = null\n        }\n      }\n    })\n  }\n\n  // Возвращаем реактивный get на value, таким образом computation, который\n  // внутри вызывает computed(fn) будет зависеть динамически только\n  // от результата fn, а не от всех ее внутренностей\n  return fn[_source_].value$\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction compound (fn) {\n  const parentStack = curStack\n  curStack = []\n  fn()\n  for (const f of curStack) {\n    f()\n  }\n  curStack = parentStack\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n// TODO: подумать над реактивным индексом\n// возможно что-то вроде Epos.dynamic(i) или i.value$\nfunction createStream (sourceArray, fn) {\n  const stream = createSourceArray(sourceArray.map(item => fn(item)))\n\n  // Помечаем поток, чтобы при рендеринге отличать его от массива\n  stream[_isStream_] = true\n\n  // Слушаем splice$\n  onSplice(sourceArray, (start, removeCount, ...items) => {\n    // Трансформируем новые значения\n    items = items.map(item => fn(item))\n\n    // Делаем реактивный splice$, чтобы стриггерить слушателей потока, если такие имеются\n    stream.splice$(start, removeCount, ...items)\n  })\n\n  return stream\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Самая сложная для понимания часть библиотеки. Все реактивные вещи —\n * это autorun. Вызов autorun создает новый computation.\n *\n * isStandalone создает standalone-computation вместо обычного, это означает,\n * что такой computation не будет остановлен при остановке computation-родителя.\n * Точнее даже так: у такого computation-а не будет родителя, даже если\n * иерархически родитель есть. Такой computation можно остановить только\n * вручную вызвав метод stop.\n *\n * TODO: добавить описание\n * TODO: проверить, может реализация через класс добавит производительности\n */\nfunction autorun (fn, isStandalone = false) {\n  // Тут хранятся change-наборы зависимых переменных\n  let deps = new Set()\n\n  const comp = {\n    stop,\n    [_children_]: []\n  }\n\n  if (curNode) {\n    curNode[_comps_].push(comp)\n  }\n\n  // Если есть родительский computation и autorun не в standalone-режиме,\n  // то прописываем себя в дети родителя\n  if (curComp && !isStandalone) {\n    curComp[_children_].push(comp)\n  }\n\n  run()\n\n  return comp\n\n  function run () {\n    stop()\n    const parentGet = curGet\n    const parentComp = curComp\n    curGet = get\n    curComp = comp\n    fn(comp)\n    curGet = parentGet\n    curComp = parentComp\n\n    // Если `curComp` оказался null-ом, значит это закончил свое перевычисление\n    // root-computation (см. описание `afterRun` выше).\n    if (curComp === null) {\n      callFns(afterRun)\n      afterRun.clear()\n    }\n  }\n\n  function get (change) {\n    // Добавляем зависимость\n    change.add(run)\n    deps.add(change)\n  }\n\n  function stop () {\n    // Останавливаем всех детей\n    for (const child of comp[_children_]) {\n      child.stop()\n    }\n    comp[_children_] = []\n\n    // Удаляем все связанные зависимости\n    for (const change of Array.from(deps)) {\n      change.delete(run)\n    }\n    deps.clear()\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction render (template) {\n  let result\n  autorun(() => {\n    const prev = isStandaloneRender\n    isStandaloneRender = true\n    result = renderInternal(template)\n    isStandaloneRender = prev\n  }, true)\n  return result\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction renderInternal (template, isSvg) {\n  if (template instanceof window.Node) {\n    return template\n  }\n\n  if (isStringOrNumber(template)) {\n    return document.createTextNode(template)\n  }\n\n  if (isObject(template)) {\n    return renderObject(template, isSvg)\n  }\n\n  if (isArray(template)) {\n    return renderArray(template, isSvg)\n  }\n\n  if (isFunction(template)) {\n    return renderFunction(template, isSvg)\n  }\n\n  if (isStream(template)) {\n    return renderStream(template, isSvg)\n  }\n\n  return document.createTextNode('')\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction renderObject (template, isSvg) {\n  // const parentComp = curComp\n  // const comp = {\n  //   stop () {\n  //     for (const child of comp[_children_]) {\n  //       child.stop()\n  //     }\n  //     comp[_children_] = []\n  //   },\n  //   [_children_]: []\n  // }\n  // if (parentComp) {\n  //   parentComp[_children_].push(comp)\n  // }\n  // curComp = comp\n  // node.comp = comp\n  // curComp = parentComp\n\n  // Preprocess with plugins\n  const stateByPlugin = new Map()\n  for (const plugin of plugins) {\n    if (plugin.preprocess) {\n      const state = {}\n      stateByPlugin.set(plugin, state)\n      plugin.preprocess({ state, template })\n    }\n  }\n\n  // Cleanup template by plugins\n  for (const plugin of plugins) {\n    if (plugin.cleanupTemplate) {\n      plugin.cleanupTemplate({ template })\n    }\n  }\n\n  // Create node\n  let node\n  const tag = template.tag || 'div'\n  if (tag === 'svg') {\n    isSvg = true\n  }\n  // TODO: process <foreignObject>\n  if (isSvg) {\n    node = document.createElementNS('http://www.w3.org/2000/svg', tag)\n  } else {\n    node = document.createElement(tag)\n  }\n\n  node[_comps_] = []\n  const parentNode = curNode\n\n  // This fixes show/hide post after toggling show hidden in unifeed\n  if (!isStandaloneRender) {\n    curNode = node\n  }\n\n  // Set attributes and add event listeners\n  for (const key in template) {\n    if (key === 'tag' || key === 'inner') {\n      continue\n    }\n\n    const value = template[key]\n    if (events.includes(key.toLowerCase()) && isFunction(value)) {\n      node.addEventListener(key.toLowerCase().slice(2), value)\n    } else {\n      autorun(() => {\n        setAttributeSafe(node, key, isFunction(value) ? value() : value, isSvg)\n      })\n    }\n  }\n\n  // Render children and attach them to the node\n  const children = toFlatArray(renderInternal(template.inner, isSvg))\n  for (const child of children) {\n    node.appendChild(child)\n  }\n\n  // Postprocess with plugins\n  for (const plugin of plugins) {\n    if (plugin.postprocess) {\n      const state = stateByPlugin.get(plugin)\n      // TODO: probably remove `template` from args?\n      plugin.postprocess({ state, template, node })\n    }\n  }\n\n  curNode = parentNode\n\n  return node\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction setAttributeSafe (node, key, value, isSvg) {\n  // `value` is valid => set attribute\n  if (isStringOrNumber(value) || typeof value === 'boolean') {\n    // Если поле есть на элементе, то меняем его, иначе — ставим атрибут.\n    // Почему так? Например, для input-ов есть поле value и менять его\n    // следует именно через input.value, а не через\n    // input.setAttribute('value', ...)\n    if (key in node && !isSvg) {\n      node[key] = value\n    } else {\n      node.setAttribute(key, value)\n    }\n  // Otherwise => delete attribute\n  } else {\n    node.removeAttribute(key)\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction renderArray (template, isSvg) {\n  const [startNode, endNode] = createBoundaryNodes()\n  return [\n    startNode,\n    ...toFlatArray(template.map(i => renderInternal(i, isSvg))),\n    endNode\n  ]\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction renderFunction (template, isSvg) {\n  const [startNode, endNode] = createBoundaryNodes()\n  let isFirstRun = true\n  let nodes\n\n  autorun(() => {\n    const newNodes = toFlatArray(renderInternal(template(), isSvg))\n\n    if (isFirstRun) {\n      nodes = newNodes\n      isFirstRun = false\n    } else {\n      // Create fragment with new nodes\n      const fragment = document.createDocumentFragment()\n      for (const newNode of newNodes) {\n        fragment.appendChild(newNode)\n      }\n\n      // Remove all nodes between start and end\n      while (startNode.nextSibling !== endNode) {\n        removeNode(startNode.nextSibling)\n      }\n\n      // Insert fragment between start and end\n      endNode.parentNode.insertBefore(fragment, endNode)\n    }\n  })\n\n  return [startNode, ...nodes, endNode]\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction renderStream (stream, isSvg) {\n  const nodes = renderArray(stream)\n  const startNode = nodes[0]\n  const endNode = nodes[nodes.length - 1]\n\n  // TODO: порефакторить все, что внутри\n  onSplice(stream, (start, removeCount, ...items) => {\n    let i = 0\n    let cursor = startNode.nextSibling\n\n    if (!cursor) {\n      // probably rerun of already removed elements\n      console.log('strange')\n      return\n    }\n\n    const children = []\n\n    while (cursor !== endNode) {\n      if (cursor[_boundaryId_]) {\n        const nodes2 = []\n        const boundaryId = cursor[_boundaryId_]\n        while (true) {\n          nodes2.push(cursor)\n          cursor = cursor.nextSibling\n          if (cursor[_boundaryId_] === boundaryId) {\n            nodes2.push(cursor)\n            break\n          }\n        }\n        children.push(nodes2)\n      } else {\n        children.push(cursor)\n      }\n\n      cursor = cursor.nextSibling\n    }\n\n    const nodesToRemove = []\n    const bef = toFlatArray(children[start] || endNode)[0]\n\n    for (i = 0; i < removeCount; i++) {\n      const cc = toFlatArray(children[start + i])\n      for (const c of cc) {\n        nodesToRemove.push(c)\n      }\n    }\n\n    for (const item of items) {\n      const ii = toFlatArray(renderInternal(item, isSvg))\n      for (const i of ii) {\n        bef.parentNode.insertBefore(i, bef)\n      }\n    }\n\n    for (const n of nodesToRemove) {\n      removeNode(n)\n    }\n  })\n\n  return nodes\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction addRenderPlugin (plugin) {\n  plugins.push(plugin)\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction renderRaw (string) {\n  const div = renderInternal({})\n  div.innerHTML = string\n  return Array.from(div.childNodes)\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Stops all dynamic computations for the given node\n */\nfunction suspend (node) {\n  if (node && node[_comps_]) {\n    for (const comp of node[_comps_]) {\n      comp.stop()\n    }\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction removeNode (node) {\n  node.remove()\n  suspend(node)\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Adds splice listener for the given source-array\n */\nfunction onSplice (sourceArray, fn) {\n  sourceArray[_splice_].add(fn)\n\n  // Stop listener if current computation stops\n  if (curComp) {\n    onStop(curComp, () => {\n      sourceArray[_splice_].delete(fn)\n    })\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Calls all given functions one by one\n * fns = Array/Set\n */\nfunction callFns (fns, ...args) {\n  for (const fn of Array.from(fns)) {\n    fn(...args)\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Same as `callFns`, but stack-aware.\n * If inside compound => push fns to stack instead of calling\n */\nfunction callFnsStack (fns, ...args) {\n  if (!fns) {\n    return\n  }\n\n  if (curStack) {\n    // curStack.push(() => {\n    //   const executed = new Set()\n    //   for (const fn of Array.from(fns)) {\n    //     if (!executed.has(fn)) {\n    //       fn(...args)\n    //       executed.add(fn)\n    //     }\n    //   }\n    // })\n    curStack.push(call)\n  } else {\n    call()\n  }\n\n  function call () {\n    callFns(fns, ...args)\n  }\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n/**\n * Returns a list of all possible DOM events: \"onclick\", \"onmousedown\", etc.\n * https://css-tricks.com/snippets/javascript/get-possible-dom-events/\n */\nfunction getAllPossibleEventNames () {\n  const events = []\n  for (const key in document) {\n    const value = document[key]\n    if (key.startsWith('on') && (value === null || isFunction(value))) {\n      events.push(key)\n    }\n  }\n\n  return events\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction createBoundaryNodes () {\n  const startNode = document.createTextNode('')\n  const endNode = document.createTextNode('')\n  startNode[_boundaryId_] = boundaryId\n  endNode[_boundaryId_] = boundaryId\n  boundaryId += 1\n  return [startNode, endNode]\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction onStop (comp, fn) {\n  comp[_children_].push({\n    stop () {\n      fn()\n    }\n  })\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction isStringOrNumber (any) {\n  return typeof any === 'string' || typeof any === 'number'\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction isFunction (any) {\n  return typeof any === 'function'\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction isObject (any) {\n  return Object.prototype.toString.call(any) === '[object Object]'\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction isArray (any) {\n  return Array.isArray(any) && !any[_isStream_]\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction isStream (any) {\n  return any && any[_isStream_]\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\nfunction toFlatArray (any) {\n  return isArray(any) ? any.flat() : [any]\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\naddRenderPlugin({\n  preprocess ({ template, state }) {\n    const ordered = template.ordered\n    if (ordered) {\n      state.ordered = ordered\n      if (ordered.items.map$) {\n        template.inner = ordered.items.map(ordered.render)\n      } else {\n        template.inner = ordered.items.map(ordered.render)\n      }\n    }\n  },\n\n  cleanupTemplate ({ template }) {\n    delete template.ordered\n  },\n\n  postprocess ({ state, node }) {\n    const ordered = state.ordered\n    if (!ordered) {\n      return\n    }\n\n    const items = [...ordered.items]\n\n    const d = !!ordered.items._deb\n\n    let originalOrder = [...ordered.items]\n    if (ordered.items.map$) {\n      onSplice(ordered.items, () => {\n        originalOrder = [...ordered.items]\n        const nextOrder = [...originalOrder].sort(ordered.compare)\n        reorderChildren(node, items, nextOrder, ordered.render, ordered.withAnimation) // items becomes nextOrder\n      })\n    }\n\n    // if (items.map$) {\n    //   onSplice(items, () => {\n    //     originalOrder.items = [...items]\n    //     const nextOrder = [...originalOrder.items]\n    //     nextOrder.sort(ordered.compare)\n    //     reorderChildren(node, items, nextOrder) // items becomes nextOrder\n    //   });\n    // }\n\n    autorun(() => {\n      const nextOrder = [...originalOrder].sort(ordered.compare)\n      reorderChildren(node, items, nextOrder, ordered.render, ordered.withAnimation) // items becomes nextOrder\n    })\n  }\n})\n\n// TODO: нужно научить stream-ы не только в splice, но и в перемещение\n// из index1 в index2, тогда sort$ — это стрим и рендерим как обычный стрим\n\nfunction reorderChildren (root, order, nextOrder, renderItem, withAnimation = false) {\n  if (withAnimation) {\n    for (const elem of root.children) {\n      const rect = elem.getBoundingClientRect()\n      elem._prevPosition = {\n        left: rect.left,\n        top: rect.top\n      }\n    }\n  }\n\n  // console.log('--------');\n  // console.log('REORDER');\n  // console.log({from: [...order], to: [...nextOrder]});\n\n  // TODO: нужно что-то придумать с потерей фокуса у инпутов\n  // (исчезают из-за фрагментов)\n  // Может так: если input и в фокусе, то делаем без фрагментов (медленно)\n  // Иначе с фрагментами (быстро)\n\n  // let rangeBefore = getSelection().getRangeAt(0);\n  // rangeBefore = {\n  //   startContainer: rangeBefore.startContainer,\n  //   startOffset: rangeBefore.startOffset,\n  //   endContainer: rangeBefore.endContainer,\n  //   endOffset: rangeBefore.endOffset\n  // };\n\n  order.forEach(item => {\n    // Item is removed\n    if (!nextOrder.includes(item)) {\n      const index = order.indexOf(item)\n      order.splice(index, 1)\n      removeByIndex(root, index)\n    }\n  })\n\n  // const moveElems = []\n\n  // nextOrder.forEach((nextItem, nextIndex) => {\n  //   const index = order.indexOf(nextItem)\n  //   if (index === -1) {\n  //     // order.splice(nextIndex, 0, nextItem)\n  //     // const newElem = render(renderItem(nextItem))\n  //     // root.insertBefore(newElem, getFirstNodeByIndex(root, nextIndex))\n  //   } else if (index !== nextIndex) {\n  //     // Передаем false для isTake, только чтобы позиции запомнить\n  //     const fragment = takeByIndex(root, index, false)\n  //   }\n  // })\n\n  nextOrder.forEach((nextItem, nextIndex) => {\n    // Item added\n    const index = order.indexOf(nextItem)\n    if (index === -1) {\n      order.splice(nextIndex, 0, nextItem)\n      const newElems = toFlatArray(render(renderItem(nextItem)))\n      const fragment = document.createDocumentFragment()\n      newElems.forEach(newElem => {\n        fragment.appendChild(newElem)\n      })\n      root.insertBefore(fragment, getFirstNodeByIndex(root, nextIndex))\n    }\n  })\n\n\n  nextOrder.forEach((nextItem, nextIndex) => {\n    const index = order.indexOf(nextItem)\n\n    // New item\n    if (index === -1) {\n      // order.splice(nextIndex, 0, nextItem)\n      // const newElem = render(renderItem(nextItem))\n      // root.insertBefore(newElem, getFirstNodeByIndex(root, nextIndex))\n\n    // Item changes position\n    } else if (index !== nextIndex) {\n      // console.log('> CHANGE POS');\n      // console.log({from: index, to: nextIndex});\n      changePosition(root, index, nextIndex)\n\n      // Move item from `index` to `nextIndex`\n      const itemAtIndex = order.splice(index, 1)[0]\n      order.splice(nextIndex, 0, itemAtIndex)\n    }\n  })\n  // moveElems.forEach(elem => {\n  //   elem._move()\n  // })\n\n\n  if (withAnimation) {\n    let delay = 10\n    for (const elem of root.children) {\n      const prevPosition = elem._prevPosition\n\n      if (!prevPosition || (prevPosition.left === 0 && prevPosition.top === 0)) {\n        continue\n      }\n\n      delete elem._prevPosition\n      requestAnimationFrame(() => {\n        const nextPosition = elem.getBoundingClientRect()\n        if (\n          prevPosition.left === nextPosition.left &&\n          prevPosition.top === nextPosition.top\n        ) {\n          return\n        }\n\n        const dx = nextPosition.left - prevPosition.left\n        const dy = nextPosition.top - prevPosition.top\n        elem.style.transition = 'none';\n        elem.style.transform = `translate(${-dx}px, ${-dy}px)`\n        setTimeout(() => {\n          elem.style.transition = 'transform 0.5s ease';\n          elem.style.transform = 'translate(0, 0)';\n        }, delay)\n        delay += 50\n      })\n    }\n  }\n\n  // moveElems.forEach(elem => {\n  //   const nextPosition = elem.getBoundingClientRect()\n  //   if (elem._prevPosition) {\n  //     const dx = nextPosition.left - elem._prevPosition.left\n  //     const dy = nextPosition.top - elem._prevPosition.top\n  //     elem.style.transition = 'none';\n  //     elem.style.transform = `translate(${-dx}px, ${-dy}px)`\n  //     // elem.offsetWidth // force redraw\n  //     setTimeout(() => {\n  //       elem.style.transition = 'transform 0.5s ease';\n  //       elem.style.transform = 'translate(0, 0)';\n  //     }, 10)\n  //   }\n  // })\n\n\n  // if (rangeBefore) {\n  //   console.log(rangeBefore);\n  //   const range = document.createRange()\n  //   range.setStart(rangeBefore.startContainer, rangeBefore.startOffset)\n  //   range.setEnd(rangeBefore.endContainer, rangeBefore.endOffset)\n  //   getSelection().removeAllRanges()\n  //   getSelection().addRange(range)\n  // }\n}\n\nfunction takeByIndex (elem, index, isTake = false) {\n  let i = 0\n  let cursor = elem.childNodes[0][_boundaryId_]\n    ? elem.childNodes[1]\n    : elem.childNodes[0]\n\n  while (true) {\n    if (!cursor) {\n      return null\n    }\n\n    const boundaryId = cursor[_boundaryId_]\n    if (boundaryId) {\n      let fragment\n      if (i === index) {\n        fragment = document.createDocumentFragment()\n      }\n\n      while (true) {\n        const nextSibling = cursor.nextSibling\n\n        // Hack for animation reorder\n        if (cursor.getBoundingClientRect && !isTake) {\n          cursor._prevPosition = cursor.getBoundingClientRect()\n        }\n\n        if (isTake && fragment) {\n          fragment.appendChild(cursor)\n        }\n\n        cursor = nextSibling\n        if (!cursor) {\n          return null\n        }\n        if (cursor[_boundaryId_] === boundaryId) {\n          // Hack for animation reorder\n          if (cursor.getBoundingClientRect && !isTake) {\n            cursor._prevPosition = cursor.getBoundingClientRect()\n          }\n\n          if (isTake && fragment) {\n            fragment.appendChild(cursor)\n          }\n          break\n        }\n      }\n\n      if (fragment) {\n        return fragment\n      }\n    } else {\n      if (i === index) {\n        const fragment = document.createDocumentFragment()\n\n        // Hack for animation reorder\n        if (cursor.getBoundingClientRect && !isTake) {\n          cursor._prevPosition = cursor.getBoundingClientRect()\n        }\n\n        if (isTake && fragment) {\n          fragment.appendChild(cursor)\n        }\n\n        return fragment\n      }\n    }\n    i += 1\n    cursor = cursor.nextSibling\n  }\n}\n\nfunction removeByIndex (root, index) {\n  const nodesAtIndex = []\n\n  let i = 0\n  let cursor = root.childNodes[0][_boundaryId_]\n    ? root.childNodes[1]\n    : root.childNodes[0]\n\n  while (true) {\n    if (!cursor) {\n      break\n    }\n\n    const boundaryId = cursor[_boundaryId_]\n    const isIndex = (i === index)\n    if (boundaryId) {\n      while (true) {\n        if (isIndex) {\n          nodesAtIndex.push(cursor)\n        }\n        cursor = cursor.nextSibling\n        if (!cursor) {\n          break\n        }\n        if (cursor && cursor[_boundaryId_] === boundaryId) {\n          if (isIndex) {\n            nodesAtIndex.push(cursor)\n          }\n          break\n        }\n      }\n      if (isIndex) {\n        break\n      }\n    } else if (isIndex) {\n      nodesAtIndex.push(cursor)\n      break\n    }\n\n    i += 1\n    cursor = cursor.nextSibling\n  }\n\n  nodesAtIndex.forEach(node => {\n    root.removeChild(node)\n  })\n}\n\nfunction changePosition (root, oldIndex, newIndex) {\n  const nodesAtOldIndex = []\n\n  let i = 0\n  let cursor = root.childNodes[0][_boundaryId_]\n    ? root.childNodes[1]\n    : root.childNodes[0]\n\n  while (true) {\n    if (!cursor) {\n      break\n    }\n\n    const boundaryId = cursor[_boundaryId_]\n    const isOldIndex = (i === oldIndex)\n    if (boundaryId) {\n      while (true) {\n        if (isOldIndex) {\n          nodesAtOldIndex.push(cursor)\n        }\n        cursor = cursor.nextSibling\n        if (!cursor) {\n          break\n        }\n        if (cursor && cursor[_boundaryId_] === boundaryId) {\n          if (isOldIndex) {\n            nodesAtOldIndex.push(cursor)\n          }\n          break\n        }\n      }\n      if (isOldIndex) {\n        break\n      }\n    } else if (isOldIndex) {\n      nodesAtOldIndex.push(cursor)\n      break\n    }\n\n    i += 1\n    cursor = cursor.nextSibling\n  }\n\n  const firstNodeAtNewIndex = getFirstNodeByIndex(root, newIndex)\n  nodesAtOldIndex.forEach(node => {\n    root.insertBefore(node, firstNodeAtNewIndex)\n  })\n}\n\n\nfunction getFirstNodeByIndex (elem, index) {\n  let i = 0\n  let cursor = elem.childNodes[0][_boundaryId_]\n    ? elem.childNodes[1]\n    : elem.childNodes[0]\n\n  while (true) {\n    if (!cursor) {\n      return null\n    }\n\n    const boundaryId = cursor[_boundaryId_]\n    if (boundaryId) {\n      if (i === index) {\n        return cursor\n      }\n      while (true) {\n        cursor = cursor.nextSibling\n        if (!cursor) {\n          return null\n        }\n        if (cursor[_boundaryId_] === boundaryId) {\n          break\n        }\n      }\n    } else {\n      if (i === index) {\n        return cursor\n      }\n    }\n    i += 1\n    cursor = cursor.nextSibling\n  }\n}\n","export default function bemClassProcessor (props = {}) {\n  if (typeof props === 'string') {\n    return props\n  }\n\n  const className = props.name\n  const mods = {...props}\n  delete mods.name\n\n  if (!mods) {\n    return className\n  }\n\n  if (typeof mods === 'string') {\n    return `${className} ${className}_${mods}`\n  }\n\n  const classes = [className]\n  Object.keys(mods).forEach(k => {\n    const v = mods[k]\n    if (v === true) {\n      classes.push(`${className}_${k}`)\n    } else if (typeof v === 'number' || (typeof v === 'string' && v)) {\n      classes.push(`${className}_${k}_${v}`)\n    }\n  })\n\n  return classes.join(' ')\n}\n","import { autorun } from '/lib/epos.js'\n\n/**\n * Copyright (c) Konstantin Zemtsovsky\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst _prevClassList_ = Symbol('prevClassList')\nlet classProcessor = (c) => c\n\nexport default {\n  setClassProcessor (fn) {\n    classProcessor = fn\n  },\n\n  preprocess ({ state, template }) {\n    if (template.class) {\n      state.class = template.class\n    }\n  },\n\n  cleanupTemplate ({ template }) {\n    if (template.class) {\n      delete template.class\n    }\n  },\n\n  postprocess ({ state, node }) {\n    if (!state.class) {\n      return\n    }\n\n    autorun(() => {\n      const prevClassList = node[_prevClassList_] || []\n      const nextClassList = [].concat(typeof state.class === 'function' ? state.class() : state.class)\n        .filter(Boolean)\n        .map(classProcessor)\n        .filter(c => c && typeof c === 'string')\n        .join(' ')\n        .split(/\\s+/)\n\n      node[_prevClassList_] = nextClassList\n\n      for (const className of nextClassList) {\n        if (className && typeof className === 'string' && !prevClassList.includes(className)) {\n          node.classList.add(className)\n        }\n      }\n\n      for (const className of prevClassList) {\n        if (!nextClassList.includes(className)) {\n          node.classList.remove(className)\n        }\n      }\n    })\n  }\n}\n","export default {\n  preprocess ({ state, template }) {\n    if (template.onCreate) {\n      state.onCreate = template.onCreate\n      delete template.onCreate\n    }\n  },\n\n  postprocess ({ state, node }) {\n    if (state.onCreate) {\n      state.onCreate(node)\n    }\n  }\n}\n","const elementsToObserve = new Set()\n\nexport default {\n  preprocess ({ state, template }) {\n    if (!template) {\n      return\n    }\n\n    if (template.onMount) {\n      state.onMount = template.onMount\n      delete template.onMount\n    }\n\n    if (template.onUnmount) {\n      state.onUnmount = template.onUnmount\n      delete template.onUnmount\n    }\n  },\n  postprocess ({ state, template, node }) {\n    if (state.onMount || state.onUnmount) {\n      elementsToObserve.add(node)\n      node.onMount = state.onMount\n      node.onUnmount = state.onUnmount\n      startMo()\n    }\n  }\n}\n\nconst mo = new MutationObserver(mutations => {\n  Array.from(elementsToObserve).forEach(elem => {\n    if (elem.__isMounted) {\n      if (!document.contains(elem)) {\n        if (elem.onUnmount) {\n          elem.onUnmount(elem)\n        }\n        elementsToObserve.delete(elem)\n        if (elementsToObserve.size === 0) {\n          stopMo()\n        }\n      }\n    } else {\n      if (document.contains(elem)) {\n        elem.__isMounted = true\n        if (elem.onMount) {\n          elem.onMount(elem)\n        }\n      }\n    }\n  })\n})\n\nfunction startMo () {\n  if (mo.__started) {\n    return\n  }\n  mo.__started = true\n  mo.observe(document, { childList: true, subtree: true })\n}\n\nfunction stopMo () {\n  if (mo.__started) {\n    mo.__started = false\n    mo.disconnect()\n  }\n}\n","import { dynamic } from '/lib/epos.js'\n\nexport default Object.assign(store, {\n  init: initStore\n})\n\nlet st\n\nfunction store () {\n  return st\n}\n\nfunction initStore (data) {\n  st = dynamic(data)\n}\n","import store from '/store.js'\n\nexport default function App () {\n  return {\n    class: 'App',\n    inner: store().todos.map$(item => {\n      return {\n        class: () => ({ name: 'App__todo', done: item.done$ }),\n        onClick: () => item.done$ = !item.done,\n        inner: () => item.text$\n      }\n    })\n  }\n}\n","import { render } from '/lib/epos.js'\nimport bemClassProcessor from '/lib/epos-bem-class-processor.js'\nimport pluginClassArray from '/lib/epos-plugin-class-array.js'\nimport pluginOnCreate from '/lib/epos-plugin-on-create.js'\nimport pluginMountUnmount from '/lib/epos-plugin-mount-unmount.js'\nimport store from '/store.js'\nimport App from '/ui/app.js'\n\n;(function main () {\n  pluginClassArray.setClassProcessor(bemClassProcessor)\n  render.addPlugin(pluginClassArray)\n  render.addPlugin(pluginOnCreate)\n  render.addPlugin(pluginMountUnmount)\n\n  store.init({\n    todos: [\n      { text: 'Learn epos', done: false },\n      { text: 'Write todolist', done: false }\n    ]\n  })\n\n  const $app = render(App())\n  document.body.appendChild($app)\n})()\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}